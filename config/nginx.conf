# Nginx snippet to protect admin authentication endpoints.
# Include this file inside the appropriate server {} block.

# Redirect legacy entry point to the main admin login and prevent caching.
location = /auth.php {
    add_header Cache-Control "no-store" always;
    return 302 /admin/auth.php;
}

# Block execution of any other auth.php files to avoid exposing alternate forms.
location ~ ^/(?!admin/auth\.php$).*auth\.php$ {
    return 404;
}
